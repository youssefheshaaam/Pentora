<!DOCTYPE html>
<html>
<head>
	<title>Pentora scan report</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" type="text/css" href="css/kube.min.css" />
    <link rel="stylesheet" type="text/css" href="css/master.css" />
</head>
<body>
    <div id="page">
        <header style="text-align: center">
        <h2 class="title" style="text-align: center">Pentora vulnerability report</h2>
        <h3>Target: http://localhost:8000/vulnerabilities/upload/</h3>
        <p>Date of the scan: Fri, 04 Apr 2025 13:40:15 +0000. Scope of the scan: folder. Crawled pages: 10</p>
        </header>
        <hr />

        <h4>Summary</h4>
        <table class="width-100 hovered" style="background: url('Pentora_logo.png') no-repeat center;">
            <thead>
                <tr>
                    <th>Category</th>
                    <th>Number of vulnerabilities found</th>
                </tr>
            </thead>
            <tbody id="summary">
                    <tr>
                        <td class="small">
                            Backup file
                        </td>
                        <td class="small .text-centered">0</td>
                    </tr>
                    <tr>
                        <td class="small">
                            Weak credentials
                        </td>
                        <td class="small .text-centered">0</td>
                    </tr>
                    <tr>
                        <td class="small">
                            CRLF Injection
                        </td>
                        <td class="small .text-centered">0</td>
                    </tr>
                    <tr>
                        <td class="small">
                            Content Security Policy Configuration
                        </td>
                        <td class="small .text-centered">0</td>
                    </tr>
                    <tr>
                        <td class="small">
                            Cross Site Request Forgery
                        </td>
                        <td class="small .text-centered">0</td>
                    </tr>
                    <tr>
                        <td class="small">
                            Potentially dangerous file
                        </td>
                        <td class="small .text-centered">0</td>
                    </tr>
                    <tr>
                        <td class="small">
                            Command execution
                        </td>
                        <td class="small .text-centered">0</td>
                    </tr>
                    <tr>
                        <td class="small">
                            Path Traversal
                        </td>
                        <td class="small .text-centered">0</td>
                    </tr>
                    <tr>
                        <td class="small">
                            Fingerprint web application framework
                        </td>
                        <td class="small .text-centered">0</td>
                    </tr>
                    <tr>
                        <td class="small">
                            Fingerprint web server
                        </td>
                        <td class="small .text-centered">0</td>
                    </tr>
                    <tr>
                        <td class="small">
                            HTML Injection
                        </td>
                        <td class="small .text-centered">0</td>
                    </tr>
                    <tr>
                        <td class="small">
                            Clickjacking Protection
                        </td>
                        <td class="small .text-centered">0</td>
                    </tr>
                    <tr>
                        <td class="small">
                            HTTP Strict Transport Security (HSTS)
                        </td>
                        <td class="small .text-centered">0</td>
                    </tr>
                    <tr>
                        <td class="small">
                            MIME Type Confusion
                        </td>
                        <td class="small .text-centered">0</td>
                    </tr>
                    <tr>
                        <td class="small">
                            HttpOnly Flag cookie
                        </td>
                        <td class="small .text-centered">0</td>
                    </tr>
                    <tr>
                        <td class="small">
                            LDAP Injection
                        </td>
                        <td class="small .text-centered">0</td>
                    </tr>
                    <tr>
                        <td class="small">
                            Open Redirect
                        </td>
                        <td class="small .text-centered">0</td>
                    </tr>
                    <tr>
                        <td class="small">
                            Reflected Cross Site Scripting
                        </td>
                        <td class="small .text-centered">0</td>
                    </tr>
                    <tr>
                        <td class="small">
                            Secure Flag cookie
                        </td>
                        <td class="small .text-centered">0</td>
                    </tr>
                    <tr>
                        <td class="small">
                            SQL Injection
                        </td>
                        <td class="small .text-centered">0</td>
                    </tr>
                    <tr>
                        <td class="small">
                            Stored HTML Injection
                        </td>
                        <td class="small .text-centered">0</td>
                    </tr>
                    <tr>
                        <td class="small">
                            Stored Cross Site Scripting
                        </td>
                        <td class="small .text-centered">0</td>
                    </tr>
                    <tr>
                        <td class="small">
                            Blind SQL Injection
                        </td>
                        <td class="small .text-centered">0</td>
                    </tr>
                    <tr>
                        <td class="small">
                            <a href="#vuln_type_23">Unrestricted File Upload</a>
                        </td>
                        <td class="small .text-centered">4</td>
                    </tr>
                    <tr>
                        <td class="small">
                            Vulnerable software
                        </td>
                        <td class="small .text-centered">0</td>
                    </tr>
                    <tr>
                        <td class="small">
                            XML External Entity
                        </td>
                        <td class="small .text-centered">0</td>
                    </tr>
                    <tr>
                        <td class="small">
                            Internal Server Error
                        </td>
                        <td class="small .text-centered">0</td>
                    </tr>
                    <tr>
                        <td class="small">
                            Resource consumption
                        </td>
                        <td class="small .text-centered">0</td>
                    </tr>
                    <tr>
                        <td class="small">
                            Review Webserver Metafiles for Information Leakage
                        </td>
                        <td class="small .text-centered">0</td>
                    </tr>
                    <tr>
                        <td class="small">
                            Fingerprint web technology
                        </td>
                        <td class="small .text-centered">0</td>
                    </tr>
                    <tr>
                        <td class="small">
                            HTTP Methods
                        </td>
                        <td class="small .text-centered">0</td>
                    </tr>
            </tbody>
        </table>
        <hr />
        <div id="details">
                <h3 id="vuln_type_23">Unrestricted File Upload</h3>
                <dl>
                    <dt>Description</dt>
                    <dd>File upload vulnerabilities are when a web server allows users to upload files to its filesystem without sufficiently validating things like their name, type, contents, or size. Failing to properly enforce restrictions on these could allow an attacker to upload potentially dangerous files. This could even include server-side script files that enable remote code execution.</dd>
                    <dt>CVSS Score</dt>
                    <dd>
                        <span class="cvss-score high">7.5</span>
                        <span class="cvss-severity">High</span>
                        <span class="cvss-vector">CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N</span>
                    </dd>
                </dl>

                        <h4>ðŸ”¥ Vulnerability found in /vulnerabilities/upload/upload_blacklist.php 
                        <span class="cvss-score-label">CVSS: <span class="cvss-score high">7.5</span></span>
                        </h4>
                        <nav class="tabs" data-kube="tabs" data-equal="true" data-height="equal">
                            <a href="#tab-vuln-23-0-1" class="is-active">Description</a>
                            <a href="#tab-vuln-23-0-2">HTTP Request</a>
                            <a href="#tab-vuln-23-0-5">WSTG Code</a>
                        </nav>
                        <section id="tab-vuln-23-0-1" style="min-height: 124px;">
                            <pre>Unrestricted file upload vulnerability in the parameter fileToUpload</pre>
                        </section>
                        <section id="tab-vuln-23-0-2" style="min-height: 124px;" class="is-hidden">
                            <pre style="white-space: normal">
                                    POST /vulnerabilities/upload/upload_blacklist.php HTTP/1.1
                                    <br>
                                    host: localhost:8000
                                    <br>
                                    connection: keep-alive
                                    <br>
                                    user-agent: Mozilla/5.0 (Windows NT 6.1; rv:45.0) Gecko/20100101 Firefox/45.0
                                    <br>
                                    accept-language: en-US
                                    <br>
                                    accept-encoding: gzip, deflate, br
                                    <br>
                                    accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
                                    <br>
                                    referer: http://localhost:8000/vulnerabilities/upload/
                                    <br>
                                    content-length: 362
                                    <br>
                                    content-type: multipart/form-data; boundary=dbe00336b0e35ab6a4716e7592259f57
                                    <br>
                                    Content-Type: multipart/form-data; boundary=------------------------boundarystring
                                    <br>
                                    
                                    <br>
                                    ------------------------boundarystring
                                    <br>
                                    Content-Disposition: form-data; name=&#34;fileToUpload&#34;; filename=&#34;ww6xkklqsq.phtml&#34;
                                    <br>
                                    
                                    <br>
                                    ï¿½PNG
                                    <br>
                                    
                                    <br>
                                       IHDR &lt;?php $a = array(0 =&gt; &#34;hap&#34;,1 =&gt; &#34;voz&#34;,2 =&gt; &#34;reqd&#34;,3 =&gt; &#34;w8k7gl&#34;,4 =&gt; &#34;bl&#34;,5 =&gt; &#34;deh&#34;,6 =&gt; &#34;8wx&#34;);$b = array(3,2,0,6,1,5,4); foreach ($b as $v) echo $a[$v]; ?&gt;
                                    <br>
                                    ------------------------boundarystring--
                                    <br>
                            </pre>
                        </section>
                        <section id="tab-vuln-23-0-5" style="min-height: 124px;" class="is-hidden">
                            <pre>[&#39;WSTG-BUSL-08&#39;]</pre>
                        </section>
                        <h4>ðŸ”¥ Vulnerability found in /vulnerabilities/upload/upload_client_validation.php 
                        <span class="cvss-score-label">CVSS: <span class="cvss-score high">7.5</span></span>
                        </h4>
                        <nav class="tabs" data-kube="tabs" data-equal="true" data-height="equal">
                            <a href="#tab-vuln-23-1-1" class="is-active">Description</a>
                            <a href="#tab-vuln-23-1-2">HTTP Request</a>
                            <a href="#tab-vuln-23-1-5">WSTG Code</a>
                        </nav>
                        <section id="tab-vuln-23-1-1" style="min-height: 124px;">
                            <pre>Unrestricted file upload vulnerability in the parameter fileToUpload</pre>
                        </section>
                        <section id="tab-vuln-23-1-2" style="min-height: 124px;" class="is-hidden">
                            <pre style="white-space: normal">
                                    POST /vulnerabilities/upload/upload_client_validation.php HTTP/1.1
                                    <br>
                                    host: localhost:8000
                                    <br>
                                    connection: keep-alive
                                    <br>
                                    user-agent: Mozilla/5.0 (Windows NT 6.1; rv:45.0) Gecko/20100101 Firefox/45.0
                                    <br>
                                    accept-language: en-US
                                    <br>
                                    accept-encoding: gzip, deflate, br
                                    <br>
                                    accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
                                    <br>
                                    referer: http://localhost:8000/vulnerabilities/upload/
                                    <br>
                                    content-length: 350
                                    <br>
                                    content-type: multipart/form-data; boundary=b9f0a8b6b784fa30477d604c6181b418
                                    <br>
                                    Content-Type: multipart/form-data; boundary=------------------------boundarystring
                                    <br>
                                    
                                    <br>
                                    ------------------------boundarystring
                                    <br>
                                    Content-Disposition: form-data; name=&#34;fileToUpload&#34;; filename=&#34;w9ycj637vc.php&#34;
                                    <br>
                                    
                                    <br>
                                    ï¿½PNG
                                    <br>
                                    
                                    <br>
                                       IHDR &lt;?php $a = array(0 =&gt; &#34;iooh9&#34;,1 =&gt; &#34;bg&#34;,2 =&gt; &#34;sgc&#34;,3 =&gt; &#34;r7tp8m&#34;,4 =&gt; &#34;w3gvl&#34;,5 =&gt; &#34;vtf&#34;);$b = array(4,3,2,0,5,1); foreach ($b as $v) echo $a[$v]; ?&gt;
                                    <br>
                                    ------------------------boundarystring--
                                    <br>
                            </pre>
                        </section>
                        <section id="tab-vuln-23-1-5" style="min-height: 124px;" class="is-hidden">
                            <pre>[&#39;WSTG-BUSL-08&#39;]</pre>
                        </section>
                        <h4>ðŸ”¥ Vulnerability found in /vulnerabilities/upload/upload_content_type.php 
                        <span class="cvss-score-label">CVSS: <span class="cvss-score high">7.5</span></span>
                        </h4>
                        <nav class="tabs" data-kube="tabs" data-equal="true" data-height="equal">
                            <a href="#tab-vuln-23-2-1" class="is-active">Description</a>
                            <a href="#tab-vuln-23-2-2">HTTP Request</a>
                            <a href="#tab-vuln-23-2-5">WSTG Code</a>
                        </nav>
                        <section id="tab-vuln-23-2-1" style="min-height: 124px;">
                            <pre>Unrestricted file upload vulnerability in the parameter fileToUpload</pre>
                        </section>
                        <section id="tab-vuln-23-2-2" style="min-height: 124px;" class="is-hidden">
                            <pre style="white-space: normal">
                                    POST /vulnerabilities/upload/upload_content_type.php HTTP/1.1
                                    <br>
                                    host: localhost:8000
                                    <br>
                                    connection: keep-alive
                                    <br>
                                    user-agent: Mozilla/5.0 (Windows NT 6.1; rv:45.0) Gecko/20100101 Firefox/45.0
                                    <br>
                                    accept-language: en-US
                                    <br>
                                    accept-encoding: gzip, deflate, br
                                    <br>
                                    accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
                                    <br>
                                    referer: http://localhost:8000/vulnerabilities/upload/
                                    <br>
                                    content-length: 350
                                    <br>
                                    content-type: multipart/form-data; boundary=de9052431fd00bbebf25617f2c04a8c5
                                    <br>
                                    Content-Type: multipart/form-data; boundary=------------------------boundarystring
                                    <br>
                                    
                                    <br>
                                    ------------------------boundarystring
                                    <br>
                                    Content-Disposition: form-data; name=&#34;fileToUpload&#34;; filename=&#34;wkkvww6tt3.php&#34;
                                    <br>
                                    
                                    <br>
                                    ï¿½PNG
                                    <br>
                                    
                                    <br>
                                       IHDR &lt;?php $a = array(0 =&gt; &#34;oat&#34;,1 =&gt; &#34;v3sdot&#34;,2 =&gt; &#34;t&#34;,3 =&gt; &#34;193lw&#34;,4 =&gt; &#34;gxr&#34;,5 =&gt; &#34;wd23ps&#34;);$b = array(5,0,4,3,1,2); foreach ($b as $v) echo $a[$v]; ?&gt;
                                    <br>
                                    ------------------------boundarystring--
                                    <br>
                            </pre>
                        </section>
                        <section id="tab-vuln-23-2-5" style="min-height: 124px;" class="is-hidden">
                            <pre>[&#39;WSTG-BUSL-08&#39;]</pre>
                        </section>
                        <h4>ðŸ”¥ Vulnerability found in /vulnerabilities/upload/upload_unrestricted.php 
                        <span class="cvss-score-label">CVSS: <span class="cvss-score high">7.5</span></span>
                        </h4>
                        <nav class="tabs" data-kube="tabs" data-equal="true" data-height="equal">
                            <a href="#tab-vuln-23-3-1" class="is-active">Description</a>
                            <a href="#tab-vuln-23-3-2">HTTP Request</a>
                            <a href="#tab-vuln-23-3-5">WSTG Code</a>
                        </nav>
                        <section id="tab-vuln-23-3-1" style="min-height: 124px;">
                            <pre>Unrestricted file upload vulnerability in the parameter fileToUpload</pre>
                        </section>
                        <section id="tab-vuln-23-3-2" style="min-height: 124px;" class="is-hidden">
                            <pre style="white-space: normal">
                                    POST /vulnerabilities/upload/upload_unrestricted.php HTTP/1.1
                                    <br>
                                    host: localhost:8000
                                    <br>
                                    connection: keep-alive
                                    <br>
                                    user-agent: Mozilla/5.0 (Windows NT 6.1; rv:45.0) Gecko/20100101 Firefox/45.0
                                    <br>
                                    accept-language: en-US
                                    <br>
                                    accept-encoding: gzip, deflate, br
                                    <br>
                                    accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
                                    <br>
                                    referer: http://localhost:8000/vulnerabilities/upload/
                                    <br>
                                    content-length: 350
                                    <br>
                                    content-type: multipart/form-data; boundary=cf34c6652314ffdf923e3ac888a02308
                                    <br>
                                    Content-Type: multipart/form-data; boundary=------------------------boundarystring
                                    <br>
                                    
                                    <br>
                                    ------------------------boundarystring
                                    <br>
                                    Content-Disposition: form-data; name=&#34;fileToUpload&#34;; filename=&#34;wuep5llsgp.php&#34;
                                    <br>
                                    
                                    <br>
                                    ï¿½PNG
                                    <br>
                                    
                                    <br>
                                       IHDR &lt;?php $a = array(0 =&gt; &#34;bwt3&#34;,1 =&gt; &#34;iqzu2&#34;,2 =&gt; &#34;9&#34;,3 =&gt; &#34;5zgvf&#34;,4 =&gt; &#34;z0gf&#34;,5 =&gt; &#34;wvlsw&#34;);$b = array(5,3,0,1,4,2); foreach ($b as $v) echo $a[$v]; ?&gt;
                                    <br>
                                    ------------------------boundarystring--
                                    <br>
                            </pre>
                        </section>
                        <section id="tab-vuln-23-3-5" style="min-height: 124px;" class="is-hidden">
                            <pre>[&#39;WSTG-BUSL-08&#39;]</pre>
                        </section>

                <dl><dt>Solutions</dt><dd>Check the file extension against a whitelist of permitted extensions rather than a blacklist of prohibited ones. Make sure the filename doesn't contain any substrings that may be interpreted as a directory or a traversal sequence (../). Rename uploaded files to avoid collisions that may cause existing files to be overwritten. Do not upload files to the server's permanent filesystem until they have been fully validated.</dd></dl>
                <h5>References</h5>
                <ul>
                    <li><a href="https://book.hacktricks.xyz/pentesting-web/file-upload">HackTricks: File Upload</a></li>
                    <li><a href="https://portswigger.net/web-security/file-upload">PortSwigger : File upload vulnerabilities</a></li>
                    <li><a href="https://cwe.mitre.org/data/definitions/434.html">CWE-434: Unrestricted Upload of File with Dangerous Type</a></li>
                    <li><a href="https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/10-Business_Logic_Testing/08-Test_Upload_of_Unexpected_File_Types">OWASP: Test Upload of Unexpected File Types</a></li>
                </ul>
                <br />
                <hr>
        </div>
        <footer class="small" id="footer"><a href="#" id="pentora_link">Pentora 1.0.0</a> &copy; Pentora Team 2025</footer>
	</div>
    <script type="text/javascript" src="js/kube.min.js"></script>
    <script>$K.init();</script>
</body>
</html>